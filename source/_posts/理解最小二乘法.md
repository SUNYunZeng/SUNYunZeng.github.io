---
title: 理解最小二乘法
comments: true
toc: true
sticky: 2
password: ''
message: 请输入查看密码
wrong_pass_message: 抱歉，您输入的密码不对，请重试
mathjax: true
date: 2021-03-30 16:58:27
categories: 算法
tags: 数学
cover:
description: 
---

# 何为最小二乘

> 最小平方法是十九世纪统计学的主题曲。
>从许多方面来看, 它之于统计学就相当于十八世纪的微积分之于数学。
>             ----史蒂芬·史蒂格勒的《The History of Statistics》

**最小二乘是一种从一系列测量值种计算最可能真值的数学方法。**

## 小明真实的体重

在思考何为最小二乘时，先考虑这个问题：

小明是一个健身爱好者，对自己的体重要求非常苛刻，因为这涉及到下一步的训练计划与饮食安排。为了能精确测量出自己的体重，他在市场上购买了9个都号称世界最准的体重秤（小明是个土豪）。

我们知道百分百准确的体重秤是不存在的，这种理想秤只存在于商家的口中。那么，**如何根据这9个比较准确的体重秤，测量出小明的真实体重呢？**

## 可能的方案

假设每个体重秤测出小明的体重值分别为 $y_1,y_2,y_3,...,y_9$，那么可能存在以下几个方案：

1. 取平均值 $\frac{y_1+y_2+y_3+...+y_9}9$

2. 取中位数 $medium({y_1,y_2,y_3,...,y_9})$

3. 取极大值或极小值

4. 取几何平均数

5. 取调和平均数

6. 掷色子

7. 看心情

有很多种方案，到底哪一种才是最合理的呢？

法国数学家，阿德里安-马里·勒让德（1752－1833）提出让总的误差的平方最小的$y$就是真值，因为他假设如果测量误差是随机的话，测量值应该围绕真值上下波动。取误差的平和的原因是为了将正负误差都统一用正数值表示。

马里·勒让德假设的体重误差和的数学表达式为：

$$S_{϶^2}=\overset9{\underset{i=1}{min(\sum\left(y-y_i\right)^2)}}$$

这是一个二次函数，其导数为 0 时，取得极小值：

$$\begin{array}{l}\frac d{dy}S_{϶^2}=\frac{\displaystyle d}{\displaystyle dy}\sum\left(y-y_i\right)^2=2\sum\left(y-y_i\right)^2\\=2\left(\left(y-y_1\right)+\left(y-y_2\right)+...+\left(y-y_9\right)\right)=0\end{array}$$

进而：

$$9y=y_1+y_2+y_3+...+y_9\;\;\Rightarrow y=\frac{y_1+y_2+y_3+...+y_9\;}9$$

验证了体重的算术平均数的确使得误差的平方和最小，也就是测量的9次体重最有可能围绕所测体重记录的平均值波动。

这也就是最小二乘法的精髓，二乘即平方，最小二乘，即测量值与真值间的误差平方和最小。

这里的测量值是简单的线性函数，其实它可以为一个非线性函数 $f(x)$。

$$S_{϶^2}=min(\sum\left(y-f(x)\right)^2)$$

其极小值时为最稳定真值。

## 测量误差的正态分布

对于马里·勒让德，数学小王子，高斯（1777－1855）心存怀疑，这个假设如果时错的咋办？

于是他用概率统计的框架对其进行验证。

他首先假设每次测量值 $x_i$ 与真值 $x$ 的测量误差 $϶_i=x-x_i$ 服从一个概率分布，对应的概率密度函数为 $p(϶)$

假设所有的测量构成一个联合概率：$L(x)$

$$\begin{array}{l}L(x)=p(\backepsilon_1)p(\backepsilon_2)p(\backepsilon_3)...p(\backepsilon_9)\\=p(x-x_1)p(x-x_2)p(x-x_3)...p(x-x_9)\end{array}$$
